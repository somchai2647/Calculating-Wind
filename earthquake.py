import streamlit as st
import pandas as pd
import numpy as np
from scipy import interpolate
from PIL import Image
import plotly.graph_objects as go
from scipy import interpolate


def img_show(name, caption='', width=True):
    image = Image.open(name)
    return st.image(image, use_column_width=width, caption=caption, )


def main():

    st.write('# ‡∏°‡∏¢‡∏ú.1301/1302-61')

    st.write('### ‡∏ï‡∏±‡∏ß‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡πÅ‡∏•‡∏∞‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Ç‡∏≠‡∏á‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£')
    important_dict = {
        '‡∏ô‡πâ‡∏≠‡∏¢': 1.0,
        '‡∏õ‡∏Å‡∏ï‡∏¥': 1.0,
        '‡∏°‡∏≤‡∏Å': 1.25,
        '‡∏™‡∏π‡∏á‡∏°‡∏≤‡∏Å': 1.5,
    }
    important = st.selectbox(label='‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç',
                             options=important_dict.keys(), key='important')
    I = important_dict[important]  # ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡πà‡∏≤ I ‡∏à‡∏≤‡∏Å dictionary
    st.write(r'Important factor, $I = %.2f$' % (I))

    st.write(
        '### ‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ú‡∏•‡∏Ç‡∏≠‡∏á‡πÅ‡∏£‡∏á‡πÅ‡∏ú‡πà‡∏ô‡∏î‡∏¥‡∏ô‡πÑ‡∏´‡∏ß ‡πÇ‡∏î‡∏¢‡∏ß‡∏¥‡∏ò‡∏µ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¢‡πå‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡πà‡∏≤')
    # ‡∏™‡∏£‡πâ‡∏≤‡∏á list ‡∏Ç‡∏≠‡∏á‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå
    cal_list = ['‡∏ß‡∏¥‡∏ò‡∏µ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¢‡πå‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡πà‡∏≤', '‡∏ß‡∏¥‡∏ò‡∏µ‡πÄ‡∏ä‡∏¥‡∏á‡∏û‡∏•‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå']

    cal = "‡∏ß‡∏¥‡∏ò‡∏µ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¢‡πå‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡πà‡∏≤"  # üëà ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô

    st.write('### ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á')
    col1, col2, col3 = st.columns(3)

    with col1:
        structure_list = ['‡∏Ñ‡∏≠‡∏ô‡∏Å‡∏£‡∏µ‡∏ï‡πÄ‡∏™‡∏£‡∏¥‡∏°‡πÄ‡∏´‡∏•‡πá‡∏Å', '‡πÄ‡∏´‡∏•‡πá‡∏Å']
        structure = st.radio(label='‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á',
                             options=structure_list, index=0, key='structure')  # ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á
    with col2:
        if structure == structure_list[0]:  # ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏≠‡∏ô‡∏Å‡∏£‡∏µ‡∏ï‡πÄ‡∏™‡∏£‡∏¥‡∏°‡πÄ‡∏´‡∏•‡πá‡∏Å
            damping_list = ['5.0%', '2.5%']  # ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏ô‡πà‡∏ß‡∏á
        else:
            damping_list = ['2.5%']  # ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏ô‡πà‡∏ß‡∏á
        damping = st.radio(label='‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏ô‡πà‡∏ß‡∏á',
                           options=damping_list, index=0, key='damping')  # ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏ô‡πà‡∏ß‡∏á
    with col3:
        H = st.number_input(
            # ‡πÉ‡∏™‡πà‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏π‡∏á‡∏Ç‡∏≠‡∏á‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£
            label=r'‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏π‡∏á‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£‡∏ß‡∏±‡∏î‡∏à‡∏≤‡∏Å‡∏û‡∏∑‡πâ‡∏ô‡∏î‡∏¥‡∏ô, $H \mathrm{~[m]}$', min_value=0.0, value=6.0, key='H')

    st.write('### ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πà‡∏á‡∏ï‡∏≠‡∏ö‡∏™‡∏ô‡∏≠‡∏á‡πÄ‡∏ä‡∏¥‡∏á‡∏™‡πÄ‡∏õ‡∏Å‡∏ï‡∏£‡∏±‡∏°')

    bkk = st.checkbox('‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏ô‡πÅ‡∏≠‡πà‡∏á‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏Ø ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà ???',
                      value=False, key='bkk')  # ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏Ç‡∏ï‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà

    if not bkk:  # ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡πÄ‡∏Ç‡∏ï‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏Ø

        # ‡∏≠‡πà‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå excel
        df_SsS1 = pd.read_excel('‡πÅ‡∏ú‡πà‡∏ô‡∏î‡∏¥‡∏ô‡πÑ‡∏´‡∏ß_table.xlsx', sheet_name='SsS1')

        col1, col2, col3 = st.columns(3)  # ‡πÅ‡∏ö‡πà‡∏á‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡πÄ‡∏õ‡πá‡∏ô 3 ‡∏™‡πà‡∏ß‡∏ô
        with col1:
            province = st.selectbox(
                # ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î
                label='‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î', options=df_SsS1['‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î'].unique(), index=12, key='province')
        with col2:
            district = st.selectbox(
                # ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏≥‡πÄ‡∏†‡∏≠
                label='‡∏≠‡∏≥‡πÄ‡∏†‡∏≠', options=df_SsS1.loc[df_SsS1['‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î'] == province, '‡∏≠‡∏≥‡πÄ‡∏†‡∏≠'], key='district')

        Ss = df_SsS1.loc[(df_SsS1['‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î'] == province) & (
            df_SsS1['‡∏≠‡∏≥‡πÄ‡∏†‡∏≠'] == district), 'Ss'].iloc[0]  # ‡∏Ñ‡πà‡∏≤ Ss ‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
        S1 = df_SsS1.loc[(df_SsS1['‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î'] == province) & (
            df_SsS1['‡∏≠‡∏≥‡πÄ‡∏†‡∏≠'] == district), 'S1'].iloc[0]  # ‡∏Ñ‡πà‡∏≤ S1 ‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•

        st.write(r'$S_s = %.3f \> g$' % (Ss))
        st.write(r'$S_1 = %.3f \> g$' % (S1))

        st.write(
            '### ‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏Å‡πâ‡∏Ñ‡πà‡∏≤‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á‡∏à‡∏≤‡∏Å‡πÅ‡∏£‡∏á‡πÅ‡∏ú‡πà‡∏ô‡∏î‡∏¥‡∏ô‡πÑ‡∏´‡∏ß‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å‡∏ú‡∏•‡∏Ç‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ä‡∏±‡πâ‡∏ô‡∏î‡∏¥‡∏ô')

        soil_type = st.selectbox(label='‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ä‡∏±‡πâ‡∏ô‡∏î‡∏¥‡∏ô', options=[
                                 'A', 'B', 'C', 'D', 'E', 'F'], index=0, key='soil_type')  # ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ä‡∏±‡πâ‡∏ô‡∏î‡∏¥‡∏ô

        def FaFv(df, S):  # ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡πà‡∏≤ Fa ‡πÅ‡∏•‡∏∞ Fv
            if S <= df['index'].min():  # ‡∏ñ‡πâ‡∏≤‡∏Ñ‡πà‡∏≤ S ‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤‡∏Ñ‡πà‡∏≤‡∏ô‡πâ‡∏≠‡∏¢‡∏™‡∏∏‡∏î‡πÉ‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                # ‡πÉ‡∏´‡πâ‡∏Ñ‡πà‡∏≤ F ‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ö‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏ô‡πâ‡∏≠‡∏¢‡∏™‡∏∏‡∏î‡πÉ‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                F = df[soil_type].iloc[0]
            elif S >= df['index'].max():  # ‡∏ñ‡πâ‡∏≤‡∏Ñ‡πà‡∏≤ S ‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤‡∏Ñ‡πà‡∏≤‡∏°‡∏≤‡∏Å‡∏™‡∏∏‡∏î‡πÉ‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                # ‡πÉ‡∏´‡πâ‡∏Ñ‡πà‡∏≤ F ‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ö‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏°‡∏≤‡∏Å‡∏™‡∏∏‡∏î‡πÉ‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                F = df[soil_type].iloc[-1]
            else:
                # ‡∏Ñ‡πà‡∏≤ y0 ‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤ S
                y0 = df.loc[df['index'] <= S, soil_type].iloc[-1]
                # ‡∏Ñ‡πà‡∏≤ y1 ‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤ S
                y1 = df.loc[df['index'] >= S, soil_type].iloc[0]

                # ‡∏Ñ‡πà‡∏≤ x0 ‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤ S
                x0 = df.loc[df['index'] <= S, 'index'].iloc[-1]
                # ‡∏Ñ‡πà‡∏≤ x1 ‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤ S
                x1 = df.loc[df['index'] >= S, 'index'].iloc[0]

                x_data = [x0, x1]  # ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• x
                y_data = [y0, y1]  # ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• y

                # ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô interpolate
                f = interpolate.interp1d(x_data, y_data)

                F = f([S])[0]  # ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡πà‡∏≤ F

            return F  # ‡∏Ñ‡∏∑‡∏ô‡∏Ñ‡πà‡∏≤ F

        # ‡∏≠‡πà‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå excel Fa
        df_Fa = pd.read_excel('‡πÅ‡∏ú‡πà‡∏ô‡∏î‡∏¥‡∏ô‡πÑ‡∏´‡∏ß_table.xlsx', sheet_name='Fa')
        # ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ index ‡∏Ç‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
        df_Fa.set_index('‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ä‡∏±‡πâ‡∏ô‡∏î‡∏¥‡∏ô', inplace=True)
        # ‡∏ó‡∏≥‡∏Å‡∏≤‡∏£ transpose ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‡∏Ñ‡∏∑‡∏≠ ‡∏™‡∏•‡∏±‡∏ö‡πÅ‡∏ñ‡∏ß‡∏Å‡∏±‡∏ö‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå
        df_Fa = df_Fa.T.reset_index().astype('float')

        # ‡∏≠‡πà‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå excel ‡πÇ‡∏î‡∏¢‡πÄ‡∏•‡∏∑‡∏≠‡∏Å sheet ‡∏ó‡∏µ‡πà‡∏ä‡∏∑‡πà‡∏≠ Fv
        df_Fv = pd.read_excel('‡πÅ‡∏ú‡πà‡∏ô‡∏î‡∏¥‡∏ô‡πÑ‡∏´‡∏ß_table.xlsx', sheet_name='Fv')
        # ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ index ‡∏Ç‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
        df_Fv.set_index('‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ä‡∏±‡πâ‡∏ô‡∏î‡∏¥‡∏ô', inplace=True)
        # ‡∏ó‡∏≥‡∏Å‡∏≤‡∏£ transpose ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‡∏Ñ‡∏∑‡∏≠ ‡∏™‡∏•‡∏±‡∏ö‡πÅ‡∏ñ‡∏ß‡∏Å‡∏±‡∏ö‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå
        df_Fv = df_Fv.T.reset_index().astype('float')

        Fa = FaFv(df_Fa, Ss)  # ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡πà‡∏≤ Fa
        Fv = FaFv(df_Fv, S1)  # ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡πà‡∏≤ Fv

        st.write(r'$F_a = %.3f \> g$' % (Fa))  # ‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡πà‡∏≤ Fa
        st.write(r'$F_v = %.3f \> g$' % (Fv))  # ‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡πà‡∏≤ Fv

        SMS = Fa*Ss  # ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡πà‡∏≤ SMS
        SM1 = Fv*S1  # ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡πà‡∏≤ SM1

        st.write(
            r'$S_{MS} = F_{a} S_{s} = %.3f \times %.3f = %.3f \> g$' % (Fa, Ss, SMS))
        st.write(
            r'$S_{M1} = F_{v} S_{1} = %.3f \times %.3f = %.3f \> g$' % (Fv, S1, SM1))

        st.write('### ‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏Å‡πâ‡∏Ñ‡πà‡∏≤‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á‡∏à‡∏≤‡∏Å‡πÅ‡∏£‡∏á‡πÅ‡∏ú‡πà‡∏ô‡∏î‡∏¥‡∏ô‡πÑ‡∏´‡∏ß‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö')

        SDS = (2/3)*SMS  # ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡πà‡∏≤ SDS
        SD1 = (2/3)*SM1  # ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡πà‡∏≤ SD1

        st.write(
            r'$S_{DS} = \frac{2}{3} S_{MS} = \frac{2}{3} \times %.3f = %.3f \> g$' % (SMS, SDS))
        st.write(
            r'$S_{D1} = \frac{2}{3} S_{M1} = \frac{2}{3} \times %.3f = %.3f \> g$' % (SM1, SD1))

    else:
        with (st.expander('‡∏Å‡∏≤‡∏£‡πÅ‡∏ö‡πà‡∏á‡πÇ‡∏ã‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏ô‡πÅ‡∏≠‡πà‡∏á‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏Ø')):
            img_show('eq_bkk_zone.png')  # ‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û

        zone = st.selectbox(label='Zone', options=np.arange(
            1, 11), key='zone')  # ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÇ‡∏ã‡∏ô

        sheet_name_ = 'bkk_equivalent'  # ‡∏ä‡∏∑‡πà‡∏≠ sheet ‡∏Ç‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•

        if damping == '5.0%':  # ‡∏ñ‡πâ‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏ô‡πà‡∏ß‡∏á 5.0%
            # ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏ä‡∏∑‡πà‡∏≠ sheet ‡∏Ç‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‡πÇ‡∏î‡∏¢‡πÄ‡∏û‡∏¥‡πà‡∏° _5.0 ‡∏ï‡πà‡∏≠‡∏ó‡πâ‡∏≤‡∏¢
            sheet_name = sheet_name_ + '_5.0'
        else:
            sheet_name = sheet_name_ + '_2.5'  # ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà 5.0% ‡∏Å‡πá‡πÄ‡∏õ‡πá‡∏ô 2.5% ‡πÅ‡∏ó‡∏ô

        # ‡∏≠‡πà‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå excel
        df_bkk = pd.read_excel('‡πÅ‡∏ú‡πà‡∏ô‡∏î‡∏¥‡∏ô‡πÑ‡∏´‡∏ß_table.xlsx', sheet_name=sheet_name)

        col = df_bkk.columns  # ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡∏Ç‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
        df_bkk = pd.melt(
            # ‡∏ó‡∏≥‡∏Å‡∏≤‡∏£ transpose ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‡∏Ñ‡∏∑‡∏≠ ‡∏™‡∏•‡∏±‡∏ö‡πÅ‡∏ñ‡∏ß‡∏Å‡∏±‡∏ö‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå
            df_bkk, id_vars=col[0], value_vars=col[1:], var_name='T', value_name='Sa').astype('float')

        SDS = df_bkk.loc[(df_bkk['zone'] == zone) & (
            df_bkk['T'] == 0.2), 'Sa'].iloc[0]  # ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡πà‡∏≤ SDS
        SD1 = df_bkk.loc[(df_bkk['zone'] == zone) & (
            df_bkk['T'] == 1.0), 'Sa'].iloc[0]  # ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡πà‡∏≤ SD1

        st.write(r'$S_{DS} = %.3f \> g$' % (SDS))
        st.write(r'$S_{D1} = %.3f \> g$' % (SD1))

    st.write('### ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏≤‡∏ö‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô‡πÇ‡∏î‡∏¢‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì')
    # calculate T of structure
    if structure == structure_list[0]:  # ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏õ‡πá‡∏ô ‡∏Ñ‡∏≠‡∏ô‡∏Å‡∏£‡∏µ‡∏ï‡πÄ‡∏™‡∏£‡∏¥‡∏°‡πÄ‡∏´‡∏•‡πá‡∏Å
        T_structure = 0.02*H  # ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡πà‡∏≤ T ‡∏Ç‡∏≠‡∏á‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á
        st.write('‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£', structure, r'$\qquad  T = 0.02H = 0.02 \times %.2f \mathrm{~m} = %.3f \mathrm{~sec}$' % (
            H, T_structure))
    else:  # ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏õ‡πá‡∏ô ‡πÄ‡∏´‡∏•‡πá‡∏Å
        T_structure = 0.03*H  # ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡πà‡∏≤ T ‡∏Ç‡∏≠‡∏á‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á
        st.write('‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£', structure, r'$\qquad  T = 0.03H = 0.03 \times %.2f \mathrm{~m} = %.3f \mathrm{~sec}$' % (
            H, T_structure))

    st.write('### ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡∏ï‡πâ‡∏≤‡∏ô‡∏ó‡∏≤‡∏ô‡πÅ‡∏ú‡πà‡∏ô‡∏î‡∏¥‡∏ô‡πÑ‡∏´‡∏ß')
    st.write(
        '‡∏Å‡∏≤‡∏£‡πÅ‡∏ö‡πà‡∏á‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡∏ï‡πâ‡∏≤‡∏ô‡∏ó‡∏≤‡∏ô‡πÅ‡∏ú‡πà‡∏ô‡∏î‡∏¥‡∏ô‡πÑ‡∏´‡∏ß‡πÇ‡∏î‡∏¢‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤‡∏à‡∏≤‡∏Å‡∏Ñ‡πà‡∏≤ $S_{DS}$ ‡πÅ‡∏•‡∏∞ $S_{D1}$ ‡∏ô‡∏µ‡πâ ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÉ‡∏´‡πâ‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏™‡πà‡∏ß‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏ô‡πà‡∏ß‡∏á‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡∏•‡∏∞ 5 **‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£‡∏ó‡∏∏‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó**')

    type_dict = {
        '1': '‡∏Å',
        '2': '‡∏Ç',
        '3': '‡∏Ñ',
        '4': '‡∏á',
    }  # ‡∏™‡∏£‡πâ‡∏≤‡∏á dictionary ‡∏Ç‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡∏ï‡πâ‡∏≤‡∏ô‡∏ó‡∏≤‡∏ô‡πÅ‡∏ú‡πà‡∏ô‡∏î‡∏¥‡∏ô‡πÑ‡∏´‡∏ß

    def type161162TS(SDS, SD1):  # ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡∏ï‡πâ‡∏≤‡∏ô‡∏ó‡∏≤‡∏ô‡πÅ‡∏ú‡πà‡∏ô‡∏î‡∏¥‡∏ô‡πÑ‡∏´‡∏ß
        # ‡∏≠‡πà‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå excel ‡πÇ‡∏î‡∏¢‡πÄ‡∏•‡∏∑‡∏≠‡∏Å sheet ‡∏ó‡∏µ‡πà‡∏ä‡∏∑‡πà‡∏≠ T1.6-1
        df = pd.read_excel('‡πÅ‡∏ú‡πà‡∏ô‡∏î‡∏¥‡∏ô‡πÑ‡∏´‡∏ß_table.xlsx', sheet_name='T1.6-1')
        df = pd.melt(df, id_vars=['min', 'max'], value_vars=[
                     # ‡∏ó‡∏≥‡∏Å‡∏≤‡∏£ transpose ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‡∏Ñ‡∏∑‡∏≠ ‡∏™‡∏•‡∏±‡∏ö‡πÅ‡∏ñ‡∏ß‡∏Å‡∏±‡∏ö‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå
                     '‡∏ô‡πâ‡∏≠‡∏¢', '‡∏õ‡∏Å‡∏ï‡∏¥', '‡∏°‡∏≤‡∏Å', '‡∏™‡∏π‡∏á‡∏°‡∏≤‡∏Å'], var_name='important', value_name='type')

        # ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡πà‡∏≤‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡∏ï‡πâ‡∏≤‡∏ô‡∏ó‡∏≤‡∏ô‡πÅ‡∏ú‡πà‡∏ô‡∏î‡∏¥‡∏ô‡πÑ‡∏´‡∏ß
        type161 = df.loc[(df['min'] <= SDS) & (df['max'] > SDS) & (
            df['important'] == important), 'type'].iloc[0]

        # ‡∏≠‡πà‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå excel ‡πÇ‡∏î‡∏¢‡πÄ‡∏•‡∏∑‡∏≠‡∏Å sheet ‡∏ó‡∏µ‡πà‡∏ä‡∏∑‡πà‡∏≠ T1.6-2
        df = pd.read_excel('‡πÅ‡∏ú‡πà‡∏ô‡∏î‡∏¥‡∏ô‡πÑ‡∏´‡∏ß_table.xlsx', sheet_name='T1.6-2')

        # ‡∏ó‡∏≥‡∏Å‡∏≤‡∏£ transpose ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‡∏Ñ‡∏∑‡∏≠ ‡∏™‡∏•‡∏±‡∏ö‡πÅ‡∏ñ‡∏ß‡∏Å‡∏±‡∏ö‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå
        df = pd.melt(df, id_vars=['min', 'max'], value_vars=[
                     '‡∏ô‡πâ‡∏≠‡∏¢', '‡∏õ‡∏Å‡∏ï‡∏¥', '‡∏°‡∏≤‡∏Å', '‡∏™‡∏π‡∏á‡∏°‡∏≤‡∏Å'], var_name='important', value_name='type')

        # ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡πà‡∏≤‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡∏ï‡πâ‡∏≤‡∏ô‡∏ó‡∏≤‡∏ô‡πÅ‡∏ú‡πà‡∏ô‡∏î‡∏¥‡∏ô‡πÑ‡∏´‡∏ß
        type162 = df.loc[(df['min'] <= SD1) & (df['max'] > SD1) & (
            df['important'] == important), 'type'].iloc[0]

        if SD1 <= SDS:  # ‡∏ñ‡πâ‡∏≤‡∏Ñ‡πà‡∏≤ SD1 ‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ö‡∏Ñ‡πà‡∏≤ SDS
            TS = SD1/SDS
        else:  # ‡∏ñ‡πâ‡∏≤‡∏Ñ‡πà‡∏≤ SD1 ‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤‡∏Ñ‡πà‡∏≤ SDS
            TS = 1.0

        return type161, type162, TS  # ‡∏Ñ‡∏∑‡∏ô‡∏Ñ‡πà‡∏≤‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡∏ï‡πâ‡∏≤‡∏ô‡∏ó‡∏≤‡∏ô‡πÅ‡∏ú‡πà‡∏ô‡∏î‡∏¥‡∏ô‡πÑ‡∏´‡∏ß

    # ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏Ç‡∏ï‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏Ø ‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏ô‡πà‡∏ß‡∏á 2.5%
    if bkk and damping == '2.5%':

        df_bkkx = pd.read_excel('‡πÅ‡∏ú‡πà‡∏ô‡∏î‡∏¥‡∏ô‡πÑ‡∏´‡∏ß_table.xlsx',
                                sheet_name=sheet_name_ + '_5.0')  # ‡∏≠‡πà‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå excel

        # ‡∏ó‡∏≥‡∏Å‡∏≤‡∏£ transpose ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‡∏Ñ‡∏∑‡∏≠ ‡∏™‡∏•‡∏±‡∏ö‡πÅ‡∏ñ‡∏ß‡∏Å‡∏±‡∏ö‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå ‡πÅ‡∏•‡∏∞‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå
        df_bkkx = pd.melt(
            df_bkkx, id_vars=col[0], value_vars=col[1:], var_name='T', value_name='Sa').astype('float')

        SDSx = df_bkkx.loc[(df_bkkx['zone'] == zone) & (
            df_bkkx['T'] == 0.2), 'Sa'].iloc[0]  # ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡πà‡∏≤ SDS
        SD1x = df_bkkx.loc[(df_bkkx['zone'] == zone) & (
            df_bkkx['T'] == 1.0), 'Sa'].iloc[0]  # ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡πà‡∏≤ SD1

        st.write('‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏™‡πà‡∏ß‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏ô‡πà‡∏ß‡∏á‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ö 5%')
        st.write(r'$S_{DS} = %.3f \> g$' % (SDSx))
        st.write(r'$S_{D1} = %.3f \> g$' % (SD1x))

        # ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡∏ï‡πâ‡∏≤‡∏ô‡∏ó‡∏≤‡∏ô‡πÅ‡∏ú‡πà‡∏ô‡∏î‡∏¥‡∏ô‡πÑ‡∏´‡∏ß function ‡∏à‡∏≤‡∏Å‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ó‡∏µ‡πà 205
        type161, type162, TTSS = type161162TS(SDSx, SD1x)

    else:
        # ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡∏ï‡πâ‡∏≤‡∏ô‡∏ó‡∏≤‡∏ô‡πÅ‡∏ú‡πà‡∏ô‡∏î‡∏¥‡∏ô‡πÑ‡∏´‡∏ß function ‡∏à‡∏≤‡∏Å‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ó‡∏µ‡πà 205
        type161, type162, TTSS = type161162TS(SDS, SD1)

    if not bkk:  # ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡πÄ‡∏Ç‡∏ï‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏Ø
        if T_structure < 0.8*TTSS:  # ‡∏ñ‡πâ‡∏≤‡∏Ñ‡πà‡∏≤ T ‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤ 0.8 ‡∏Ñ‡πà‡∏≤ TTSS
            st.write(r'‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö $\quad T = %.3f \mathrm{~sec} \quad < \quad 0.8 T_s = 0.8 \times %.3f = %.3f \mathrm{~sec}$' % (
                T_structure, TTSS, 0.8*TTSS))
            st.write(
                r'‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡∏ï‡πâ‡∏≤‡∏ô‡∏ó‡∏≤‡∏ô‡πÅ‡∏ú‡πà‡∏ô‡∏î‡∏¥‡∏ô‡πÑ‡∏´‡∏ß‡∏ï‡∏≤‡∏°‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏ó‡∏µ‡πà 1.6-1 ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô')
            type_num = type161  # ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡πà‡∏≤ type_num ‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ö type161
        else:  # ‡∏ñ‡πâ‡∏≤‡∏Ñ‡πà‡∏≤ T ‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ö 0.8 ‡∏Ñ‡πà‡∏≤ TTSS
            st.write(r'‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö $\quad T = %.3f \mathrm{~sec} \quad \ge \quad 0.8 T_s = 0.8 \times %.3f = %.3f \mathrm{~sec}$' % (
                T_structure, TTSS, 0.8*TTSS))
            st.write(
                r'‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡∏ï‡πâ‡∏≤‡∏ô‡∏ó‡∏≤‡∏ô‡πÅ‡∏ú‡πà‡∏ô‡∏î‡∏¥‡∏ô‡πÑ‡∏´‡∏ß‡∏ó‡∏µ‡πà‡πÄ‡∏Ç‡πâ‡∏°‡∏á‡∏ß‡∏î‡∏Å‡∏ß‡πà‡∏≤‡∏ï‡∏≤‡∏°‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏ó‡∏µ‡πà 1.6-1 ‡πÅ‡∏•‡∏∞ 1.6-2')
            # ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡πà‡∏≤ type_num ‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ö‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á type161 ‡πÅ‡∏•‡∏∞ type162
            type_num = max(type161, type162)
    else:  # ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏Ç‡∏ï‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏Ø
        if T_structure <= 0.5:  # ‡∏ñ‡πâ‡∏≤‡∏Ñ‡πà‡∏≤ T ‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ö 0.5
            st.write(r'‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö $\quad T = %.3f \mathrm{~sec} \quad \le \quad 0.5 \mathrm{~sec}$' % (
                T_structure))
            st.write(
                r'‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡∏ï‡πâ‡∏≤‡∏ô‡∏ó‡∏≤‡∏ô‡πÅ‡∏ú‡πà‡∏ô‡∏î‡∏¥‡∏ô‡πÑ‡∏´‡∏ß‡∏ï‡∏≤‡∏°‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏ó‡∏µ‡πà 1.6-1 ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô')
            type_num = type161  # ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡πà‡∏≤ type_num ‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ö type161
        else:  # ‡∏ñ‡πâ‡∏≤‡∏Ñ‡πà‡∏≤ T ‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤ 0.5
            st.write(r'‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö $\quad T = %.3f \mathrm{~sec} \quad > \quad 0.5 \mathrm{~sec}$' % (
                T_structure))
            st.write(
                r'‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡∏ï‡πâ‡∏≤‡∏ô‡∏ó‡∏≤‡∏ô‡πÅ‡∏ú‡πà‡∏ô‡∏î‡∏¥‡∏ô‡πÑ‡∏´‡∏ß‡∏ï‡∏≤‡∏°‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏ó‡∏µ‡πà 1.6-2 ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô')
            type_num = type162  # ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡πà‡∏≤ type_num ‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ö type162

    # ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡πà‡∏≤ type ‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ö‡∏Ñ‡πà‡∏≤‡πÉ‡∏ô dictionary ‡∏Ç‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡∏ï‡πâ‡∏≤‡∏ô‡∏ó‡∏≤‡∏ô‡πÅ‡∏ú‡πà‡∏ô‡∏î‡∏¥‡∏ô‡πÑ‡∏´‡∏ß ‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ‡∏Ñ‡πà‡∏≤ type_num ‡πÄ‡∏õ‡πá‡∏ô key
    type = type_dict[str(type_num)]

    st.write(r'‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡∏ï‡πâ‡∏≤‡∏ô‡πÅ‡∏ú‡πà‡∏ô‡∏î‡∏¥‡∏ô‡πÑ‡∏´‡∏ß: <span style="color:blue">**‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó %s**</span>' %
             (type), unsafe_allow_html=True)

    st.write('### ‡∏Ñ‡πà‡∏≤‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏ï‡∏≤‡∏°‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á')
    col1, col2, col3 = st.columns(3)
    with col1:
        R = st.number_input(
            label='Response Modification Factor, $R$', min_value=0.0, value=8.0, key='R')
    with col2:
        omega0 = st.number_input(
            label='System Overstrength Factor, $\Omega_0$', min_value=0.0, value=3.0, key='omega0')
    with col3:
        Cd = st.number_input(
            label='Deflection Amplification Factor, $C_d$', min_value=0.0, value=5.5, key='Cd')

    st.write('### ‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πà‡∏á‡∏ï‡∏≠‡∏ö‡∏™‡∏ô‡∏≠‡∏á‡πÄ‡∏ä‡∏¥‡∏á‡∏™‡πÄ‡∏õ‡∏Å‡∏ï‡∏£‡∏±‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö')
    # graph data
    if not bkk:  # ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡πÄ‡∏Ç‡∏ï‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏Ø
        if cal == cal_list[0]:  # ‡∏ñ‡πâ‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏¥‡∏ò‡∏µ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¢‡πå‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡πà‡∏≤
            if SD1 <= SDS:  # ‡∏ñ‡πâ‡∏≤‡∏Ñ‡πà‡∏≤ SD1 ‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ö‡∏Ñ‡πà‡∏≤ SDS
                T0 = 0.0  # ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡πà‡∏≤ T0 ‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ö 0
                Ts = SD1/SDS  # ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡πà‡∏≤ Ts ‡∏à‡∏≤‡∏Å‡∏™‡∏°‡∏Å‡∏≤‡∏£ Ts = SD1/SDS  ‡πÇ‡∏î‡∏¢‡∏ó‡∏µ‡πà SD1 ‡πÅ‡∏•‡∏∞ SDS ‡∏Ñ‡∏∑‡∏≠‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                # ‡∏™‡∏£‡πâ‡∏≤‡∏á array ‡∏Ç‡∏≠‡∏á‡∏Ñ‡πà‡∏≤ T ‡πÇ‡∏î‡∏¢‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏à‡∏≤‡∏Å 0 ‡∏ñ‡∏∂‡∏á Ts ‡πÅ‡∏•‡∏∞‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡∏•‡∏∞ 0.1 ‡∏à‡∏ô‡∏ñ‡∏∂‡∏á 2.0
                T_data = np.append([T0, Ts], np.arange(round(Ts, 1), 2.1, 0.1))

                # ‡∏™‡∏£‡πâ‡∏≤‡∏á array ‡∏Ç‡∏≠‡∏á‡∏Ñ‡πà‡∏≤ Sa ‡πÇ‡∏î‡∏¢‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏à‡∏≤‡∏Å SDS ‡∏ñ‡∏∂‡∏á SDS ‡πÅ‡∏•‡∏∞‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡πà‡∏≤ SDS ‡∏à‡∏ô‡∏ñ‡∏∂‡∏á SD1
                S_data = np.array([SDS, SDS])

                for T in T_data:  # ‡∏ß‡∏ô‡∏•‡∏π‡∏õ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡πà‡∏≤ Sa ‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                    if T > Ts:  # ‡∏ñ‡πâ‡∏≤‡∏Ñ‡πà‡∏≤ T ‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤‡∏Ñ‡πà‡∏≤ Ts
                        # ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡πà‡∏≤ SD1/T ‡πÉ‡∏ô array
                        S_data = np.append(S_data, [SD1/T])

                # calculate Sa of structure
                if T_structure <= Ts:  # ‡∏ñ‡πâ‡∏≤‡∏Ñ‡πà‡∏≤ T ‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ö‡∏Ñ‡πà‡∏≤ Ts
                    Sa_structure = SDS  # ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡πà‡∏≤ Sa_structure ‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ö SDS
                else:
                    Sa_structure = SD1/T_structure  # ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡πà‡∏≤ Sa_structure ‡∏à‡∏≤‡∏Å‡∏™‡∏°‡∏Å‡∏≤‡∏£ SD1/T_structure

            elif SD1 > SDS:  # ‡∏ñ‡πâ‡∏≤‡∏Ñ‡πà‡∏≤ SD1 ‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤‡∏Ñ‡πà‡∏≤ SDS
                T0 = 0.2  # ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡πà‡∏≤ T0 ‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ö 0.2
                Ts = 1.0  # ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡πà‡∏≤ Ts ‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ö 1.0
                # ‡∏™‡∏£‡πâ‡∏≤‡∏á array ‡∏Ç‡∏≠‡∏á‡∏Ñ‡πà‡∏≤ T ‡πÇ‡∏î‡∏¢‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏à‡∏≤‡∏Å 0 ‡∏ñ‡∏∂‡∏á 2.0
                T_data = np.append([0, T0, Ts], np.arange(1.1, 2.1, 0.1))
                # ‡∏™‡∏£‡πâ‡∏≤‡∏á array ‡∏Ç‡∏≠‡∏á‡∏Ñ‡πà‡∏≤ Sa ‡πÇ‡∏î‡∏¢‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏à‡∏≤‡∏Å SDS ‡∏ñ‡∏∂‡∏á SDS ‡πÅ‡∏•‡∏∞‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡πà‡∏≤ SDS ‡∏à‡∏ô‡∏ñ‡∏∂‡∏á SD1
                S_data = np.array([SDS, SDS, SD1])

                for T in T_data:  # ‡∏ß‡∏ô‡∏•‡∏π‡∏õ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡πà‡∏≤ Sa ‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                    if T > Ts:  # ‡∏ñ‡πâ‡∏≤‡∏Ñ‡πà‡∏≤ T ‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤‡∏Ñ‡πà‡∏≤ Ts
                        # ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡πà‡∏≤ SD1/T ‡πÉ‡∏ô array
                        S_data = np.append(S_data, [SD1/T])

                # calculate Sa of structure
                if T_structure <= T0:  # ‡∏ñ‡πâ‡∏≤ T_structure ‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ö T0, Sa_structure ‡∏à‡∏∞‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ö SDS
                    Sa_structure = SDS
                elif T_structure > T0 and T_structure <= Ts:
                    # ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á T0 ‡πÅ‡∏•‡∏∞ Ts
                    f = interpolate.interp1d([T0, Ts], [SDS, SD1])
                    # ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì Sa_structure ‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡∏∂‡πâ‡∏ô
                    Sa_structure = f(T_structure)
                else:
                    # ‡∏ñ‡πâ‡∏≤ T_structure ‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤ Ts, Sa_structure ‡∏à‡∏∞‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ö SD1 ‡∏´‡∏≤‡∏£‡∏î‡πâ‡∏ß‡∏¢ T_structure
                    Sa_structure = SD1/T_structure

        # adjust data for 2.5% damping ratio
        if damping == '2.5%':  # ‡∏ñ‡πâ‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏ô‡πà‡∏ß‡∏á 2.5%
            for i in range(len(T_data)):  # ‡∏ß‡∏ô‡∏•‡∏π‡∏õ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤ S_data ‡∏ï‡∏≤‡∏°‡∏Ñ‡πà‡∏≤ T_data
                if T_data[i] >= T0:  # ‡∏ñ‡πâ‡∏≤ T_data ‡∏ó‡∏µ‡πà i ‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ö T0
                    # ‡∏õ‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤ S_data ‡∏ó‡∏µ‡πà i ‡πÇ‡∏î‡∏¢‡∏Å‡∏≤‡∏£‡∏´‡∏≤‡∏£‡∏î‡πâ‡∏ß‡∏¢ 0.85
                    S_data[i] = S_data[i]/0.85
                else:  # ‡∏ñ‡πâ‡∏≤ T_data ‡∏ó‡∏µ‡πà i ‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤ T0
                    # ‡∏õ‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤ S_data ‡∏ó‡∏µ‡πà i ‡∏ï‡∏≤‡∏°‡∏™‡∏°‡∏Å‡∏≤‡∏£‡∏ô‡∏µ‡πâ
                    S_data[i] = SDS*(3.88*T_data[i]/Ts + 0.4)

            if T_structure >= T0:  # ‡∏ñ‡πâ‡∏≤ T_structure ‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ö T0
                Sa_structure = Sa_structure/0.85  # ‡∏õ‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤ Sa_structure ‡πÇ‡∏î‡∏¢‡∏Å‡∏≤‡∏£‡∏´‡∏≤‡∏£‡∏î‡πâ‡∏ß‡∏¢ 0.85
            else:  # ‡∏ñ‡πâ‡∏≤ T_structure ‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤ T0
                # ‡∏õ‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤ Sa_structure ‡∏ï‡∏≤‡∏°‡∏™‡∏°‡∏Å‡∏≤‡∏£‡∏ô‡∏µ‡πâ
                Sa_structure = SDS*(3.88*T_structure/Ts + 0.4)

    elif bkk:  # ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏Ç‡∏ï‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏Ø

        # ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤ T ‡∏ó‡∏µ‡πà‡∏°‡∏µ zone ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î
        T_data = df_bkk.loc[df_bkk['zone'] == zone, 'T']
        # ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡πà‡∏≤ Sa ‡∏ó‡∏µ‡πà‡∏°‡∏µ zone ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î
        S_data = df_bkk.loc[df_bkk['zone'] == zone, 'Sa']

        y0 = df_bkk.loc[(df_bkk['zone'] == zone) & (
            # ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ñ‡πà‡∏≤ Sa ‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢‡∏ó‡∏µ‡πà T ‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ö T_structure ‡πÉ‡∏ô zone ‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î
            df_bkk['T'] <= T_structure), :].iloc[-1]['Sa']
        y1 = df_bkk.loc[(df_bkk['zone'] == zone) & (
            # ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ñ‡πà‡∏≤ Sa ‡πÅ‡∏£‡∏Å‡∏ó‡∏µ‡πà T ‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ö T_structure ‡πÉ‡∏ô zone ‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î
            df_bkk['T'] >= T_structure), :].iloc[0]['Sa']
        x0 = df_bkk.loc[(df_bkk['zone'] == zone) & (
            # ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ñ‡πà‡∏≤ T ‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ö T_structure ‡πÉ‡∏ô zone ‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î
            df_bkk['T'] <= T_structure), :].iloc[-1]['T']
        x1 = df_bkk.loc[(df_bkk['zone'] == zone) & (
            # ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ñ‡πà‡∏≤ T ‡πÅ‡∏£‡∏Å‡∏ó‡∏µ‡πà‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ö T_structure ‡πÉ‡∏ô zone ‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î
            df_bkk['T'] >= T_structure), :].iloc[0]['T']

        # log interpolation
        # ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á log10(x0) ‡πÅ‡∏•‡∏∞ log10(x1) ‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ log10(y0) ‡πÅ‡∏•‡∏∞ log10(y1) ‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡πà‡∏≤ y
        f = interpolate.interp1d([np.log10(x0), np.log10(x1)], [
                                 np.log10(y0), np.log10(y1)])

        # ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì Sa_structure ‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡∏∂‡πâ‡∏ô ‡πÅ‡∏•‡∏∞‡πÅ‡∏õ‡∏•‡∏á‡∏Ñ‡πà‡∏≤‡∏Å‡∏•‡∏±‡∏ö‡∏à‡∏≤‡∏Å log10 ‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏≤‡∏£‡∏¢‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡∏¥‡∏ö
        Sa_structure = 10**f([np.log10(T_structure)])[0]

    # plot function
    def response_spectrum_plot(T_data, S_data):  # ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏£‡∏≤‡∏ü
        fig = go.Figure()                         # ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏£‡∏≤‡∏ü

        # main grapgh
        fig.add_trace(
            go.Scatter(
                x=T_data,
                y=S_data,
                mode='lines+markers',
                line=dict(color='blue', width=2,),
                showlegend=False,
                hoverinfo='skip',
            )
        )  # ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏£‡∏≤‡∏ü‡πÄ‡∏™‡πâ‡∏ô

        # T & Sa horizontal line
        fig.add_trace(
            go.Scatter(
                x=[min(T_data), T_structure],
                y=[Sa_structure, Sa_structure],
                mode='lines',  # 'lines+text'
                line=dict(dash='dash', width=3, color='red'),
                # text=[r'%.3f'%(Sa_structure), ''],
                # textfont=dict(color='red', size=16),
                # textposition="top right",
                hoverinfo='skip',
                showlegend=False,
            )
        )  # ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏™‡πâ‡∏ô‡πÅ‡∏ô‡∏ß‡∏ô‡∏≠‡∏ô
        if bkk:  # ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏Ç‡∏ï‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏Ø
            # ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡πà‡∏≤ x ‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ö log10(T_data ‡∏ó‡∏µ‡πà‡∏ô‡πâ‡∏≠‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î)
            x = np.log10(min(T_data))
            # ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡πà‡∏≤ y ‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ö log10(Sa_structure)
            y = np.log10(Sa_structure)
        else:
            x = min(T_data)  # ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡πà‡∏≤ x ‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ö T_data ‡∏ó‡∏µ‡πà‡∏ô‡πâ‡∏≠‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î
            y = Sa_structure  # ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡πà‡∏≤ y ‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ö Sa_structure
        fig.add_annotation(  # ‡∏™‡∏£‡πâ‡∏≤‡∏á annotation ‡∏ö‡∏ô‡∏Å‡∏£‡∏≤‡∏ü
            x=x, y=y,  # ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á x ‡πÅ‡∏•‡∏∞ y
            text=r'%.3f' % (Sa_structure),  # ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°
            xanchor="left",  # ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏Ç‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°
            yanchor="bottom",  # ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏Ç‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°
            font=dict(
                    color="red",
                    size=16
            ),  # ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏™‡∏µ‡πÅ‡∏•‡∏∞‡∏Ç‡∏ô‡∏≤‡∏î‡∏Ç‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°
            showarrow=False,  # ‡πÑ‡∏°‡πà‡πÅ‡∏™‡∏î‡∏á‡∏•‡∏π‡∏Å‡∏®‡∏£
            # xshift=10,
        )

        # T & Sa vertical line
        fig.add_trace(
            go.Scatter(
                x=[T_structure, T_structure],
                y=[0.0, Sa_structure],
                mode='lines',  # 'lines+text'
                line=dict(dash='dash', width=3, color='red'),
                hoverinfo='skip',
                showlegend=False,
            )
        )  # ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏™‡πâ‡∏ô‡πÅ‡∏ô‡∏ß‡∏ï‡∏±‡πâ‡∏á
        if bkk:  # ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏Ç‡∏ï‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏Ø
            x = np.log10(T_structure)  # ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡πà‡∏≤ x ‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ö log10(T_structure)
            y = np.log10(0.01)  # ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡πà‡∏≤ y ‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ö log10(0.01)
        else:  # ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡πÄ‡∏Ç‡∏ï‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏Ø
            x = T_structure  # ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡πà‡∏≤ x ‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ö T_structure
            y = 0.0  # ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡πà‡∏≤ y ‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ö 0
        fig.add_annotation(
            x=x, y=y,
            text=r'%.3f' % (T_structure),
            xanchor="left",
            yanchor="bottom",
            font=dict(
                    color="red",
                    size=16
            ),
            showarrow=False,
            # xshift=10,
        )  # ‡∏™‡∏£‡πâ‡∏≤‡∏á annotation ‡∏ö‡∏ô‡∏Å‡∏£‡∏≤‡∏ü

        # T & Sa marker
        fig.add_trace(
            go.Scatter(
                x=[T_structure],
                y=[Sa_structure],
                mode='markers',
                marker=dict(color='red', size=8),
                showlegend=False,
                hoverinfo='skip',
            )
        )  # ‡∏™‡∏£‡πâ‡∏≤‡∏á marker ‡∏ö‡∏ô‡∏Å‡∏£‡∏≤‡∏ü

        fig.update_layout(
            xaxis=dict(
                title='T (second)',
                fixedrange=True,
                range=[0.0, 2.0],
                rangemode="nonnegative",
                # dtick = 0.25,
            ),
            yaxis=dict(
                title='Sa (g)',
                fixedrange=True,
                range=[0.0, max(S_data)+0.05],
                scaleanchor="x", scaleratio=1,
                rangemode="nonnegative",
                # dtick = 0.2,
            ),
            margin=dict(t=20, b=40),
            height=300,
        )  # ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Å‡∏£‡∏≤‡∏ü

        if bkk:  # ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏Ç‡∏ï‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏Ø
            # ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ç‡∏≠‡∏ö‡πÄ‡∏Ç‡∏ï‡πÅ‡∏Å‡∏ô x ‡πÅ‡∏•‡∏∞‡∏õ‡∏£‡∏±‡∏ö‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏•‡∏≠‡∏Å‡∏≤‡∏£‡∏¥‡∏ó‡∏∂‡∏°
            fig.update_xaxes(range=[np.log10(0.01), np.log10(10)], type="log")
            # ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ç‡∏≠‡∏ö‡πÄ‡∏Ç‡∏ï‡πÅ‡∏Å‡∏ô y ‡πÅ‡∏•‡∏∞‡∏õ‡∏£‡∏±‡∏ö‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏•‡∏≠‡∏Å‡∏≤‡∏£‡∏¥‡∏ó‡∏∂‡∏°
            fig.update_yaxes(range=[np.log10(0.01), np.log10(1)], type="log")

        return fig  # ‡∏Ñ‡∏∑‡∏ô‡∏Ñ‡πà‡∏≤‡∏Å‡∏£‡∏≤‡∏ü

    col1, col2 = st.columns([0.7, 0.3])  # ‡πÅ‡∏ö‡πà‡∏á‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏≠‡∏á‡∏™‡πà‡∏ß‡∏ô
    with col1:
        st.plotly_chart(response_spectrum_plot(T_data, S_data),
                        theme=None, use_container_width=True)  # ‡πÅ‡∏™‡∏î‡∏á‡∏Å‡∏£‡∏≤‡∏ü

        if structure == structure_list[0]:  # ‡∏ñ‡πâ‡∏≤‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏≠‡∏ô‡∏Å‡∏£‡∏µ‡∏ï
            st.write(
                r'Period of structure, $T = %.3f \mathrm{~sec}$' % (T_structure))
        else:  # ‡∏ñ‡πâ‡∏≤‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏´‡∏•‡πá‡∏Å
            st.write(
                r'Period of structure, $T = %.3f \mathrm{~sec}$' % (T_structure))

        st.write(
            r'Acceleration of structure, $S_a = %.3f \mathrm{~g}$' % (Sa_structure))

    with col2:  # ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á

        # ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏ß‡∏Ç‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ô‡πâ‡∏≠‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î
        min_length = min(len(T_data), len(S_data))
        # ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡πà‡∏≤ T_data ‡πÉ‡∏´‡πâ‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏ß‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ö min_length
        T_data = T_data[:min_length]
        # ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡πà‡∏≤ S_data ‡πÉ‡∏´‡πâ‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏ß‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ö min_length
        S_data = S_data[:min_length]

        df = pd.DataFrame({
            'T (second)': T_data,
            'Sa (g)': S_data
        })  # ‡∏™‡∏£‡πâ‡∏≤‡∏á dataframe ‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•

        # ‡πÅ‡∏™‡∏î‡∏á dataframe
        st.dataframe(df, hide_index=True, use_container_width=True)

    st.write('### ‡πÅ‡∏£‡∏á‡πÄ‡∏â‡∏∑‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏ê‡∏≤‡∏ô‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£, $V$')

    W = st.number_input(
        # ‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á
        label='‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏ú‡∏•‡∏Ç‡∏≠‡∏á‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£, $W \mathrm{~[tonne]}$', min_value=0.0, value=500.0)

    st.write('**‡∏™‡∏±‡∏°‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏ú‡∏•‡∏ï‡∏≠‡∏ö‡∏™‡∏ô‡∏≠‡∏á‡πÅ‡∏£‡∏á‡πÅ‡∏ú‡πà‡∏ô‡∏î‡∏¥‡∏ô‡πÑ‡∏´‡∏ß**')
    Cs_ = Sa_structure*I/R  # ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡πà‡∏≤ Cs ‡∏à‡∏≤‡∏Å‡∏™‡∏°‡∏Å‡∏≤‡∏£ Cs = Sa_structure*I/R
    Cs = max(Cs_, 0.01)  # ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡πà‡∏≤ Cs ‡πÉ‡∏´‡πâ‡∏°‡∏µ‡∏Ñ‡πà‡∏≤‡πÑ‡∏°‡πà‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤ 0.01

    st.markdown(
        r'$C_s = S_a \left( \frac{I}{R} \right) \qquad\qquad \ge \qquad 0.01$')
    st.markdown(r'$\quad\>\> = %.3f \left( \frac{%.2f}{%.2f} \right) \qquad\>\> \ge \qquad 0.01$' % (
        Sa_structure, I, R))
    st.markdown(r'$\quad\>\> = %.3f \qquad\qquad\quad \ge \qquad 0.01$' % (Cs_))
    st.markdown(r'$\quad\>\> = %.3f$' % (Cs))

    st.write('**‡πÅ‡∏£‡∏á‡πÄ‡∏â‡∏∑‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏ê‡∏≤‡∏ô‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£**')
    V = Cs*W
    st.markdown(r'$V = C_s W$')
    st.markdown(
        r'$\quad = %.3f \mathrm{~g} \times %.2f \mathrm{~tonne}$' % (Cs, W))
    st.markdown(r'$\quad = %.2f \mathrm{~tonne}$' % (V))

    st.write('### ‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏à‡∏≤‡∏¢‡πÅ‡∏£‡∏á‡πÄ‡∏â‡∏∑‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏ê‡∏≤‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏£‡∏á‡∏Å‡∏£‡∏∞‡∏ó‡∏≥‡∏î‡πâ‡∏≤‡∏ô‡∏Ç‡πâ‡∏≤‡∏á')
    df_v_distribute = pd.DataFrame({
        'Floor': [4, 3, 2, 1],
        'Wi [tonne]': [125.0, 125.0, 125.0, 125.0],
        'Floor height [m]': [3.5, 3.5, 3.5, 3.5],
    })  # ‡∏™‡∏£‡πâ‡∏≤‡∏á dataframe ‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•

    st.write('**‡∏Ñ‡πà‡∏≤‡∏™‡∏±‡∏°‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏à‡∏≤‡∏¢‡πÅ‡∏£‡∏á**')
    if T_structure <= 0.5:  # ‡∏ñ‡πâ‡∏≤‡∏Ñ‡πà‡∏≤ T ‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ö 0.5
        k = 1.0            # ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡πà‡∏≤ k ‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ö 1.0
        st.write(r'‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö $\qquad T \le 0.5 \mathrm{~sec}, \qquad k = 1.0$')
    elif T_structure >= 2.5:  # ‡∏ñ‡πâ‡∏≤‡∏Ñ‡πà‡∏≤ T ‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ö 2.5
        k = 2.0           # ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡πà‡∏≤ k ‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ö 2.0
        st.write(r'‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö $\qquad T \ge 2.5 \mathrm{~sec}, \qquad k = 2.0$')
    else:
        k = 1 + (T_structure-0.5)/2  # ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡πà‡∏≤ k ‡∏à‡∏≤‡∏Å‡∏™‡∏°‡∏Å‡∏≤‡∏£ k = 1 + (T-0.5)/2
        st.write(
            r'‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö $\qquad 0.5 \mathrm{~sec} < T < 2.5 \mathrm{~sec}, \qquad k = 1+ \frac{T-0.5}{2} = 1+ \frac{%.2f-0.5}{2} = %.2f $' % (T_structure, k))

    st.write('**‡∏ï‡∏±‡∏ß‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏à‡∏≤‡∏¢‡πÅ‡∏ô‡∏ß‡∏î‡∏¥‡πà‡∏á**')
    st.write(r'$C_{v i}=\frac{w_i h_i^k}{\sum_{i=1}^{n} w_i h_i^k}$')

    st.write(r'$F_i = C_{v i} V$')

    col1, col2 = st.columns(2)
    with col1:
        st.write('**Input** (this table is editable)')
        df_v_distribute = st.data_editor(
            df_v_distribute, num_rows="dynamic", key='df_v_distribute')  # ‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
    with col2:
        st.write('**Output**')
        df_v_cal = pd.DataFrame()
        df_v_cal['hi [m]'] = df_v_distribute.loc[::-
                                                 # ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡πà‡∏≤ hi ‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                                                 1, 'Floor height [m]'].cumsum()[::-1]
        wihik = df_v_distribute['Wi [tonne]'] * \
            (df_v_cal['hi [m]']**k)  # ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡πà‡∏≤ wihik ‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
        df_v_cal['Cvi'] = wihik / wihik.sum()  # ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡πà‡∏≤ Cvi ‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
        df_v_cal['Fi [tonne]'] = df_v_cal['Cvi']*V  # ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡πà‡∏≤ Fi ‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
        # ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡πà‡∏≤ Vi ‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
        df_v_cal['Vi [tonne]'] = df_v_cal['Fi [tonne]'].cumsum()

        st.dataframe(df_v_cal, hide_index=True)  # ‡πÅ‡∏™‡∏î‡∏á dataframe
